ï¿½
_E:\Scoala\Anul III\Sem I\i.Net\Project\Microservices\Alarms\Persistence\DatabaseContext.cs
	namespace 	
Persistence
 
{ 
public 

class 
DatabaseContext  
:! "
	DbContext# ,
,, -
IDatabaseContext. >
{ 
public		 
DatabaseContext		 
(		 
DbContextOptions		 /
<		/ 0
DatabaseContext		0 ?
>		? @
options		A H
)		H I
:		J K
base		L P
(		P Q
options		Q X
)		X Y
{

 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, / 
AlarmsRecordMap0 D
(D E
)E F
)F G
;G H
} 	
public 
DbSet 
< 
AlarmsRecord &
>& '
AlarmsRecords( :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
} ï¿½
`E:\Scoala\Anul III\Sem I\i.Net\Project\Microservices\Alarms\Persistence\IDatabaseContext.cs
	namespace 	
Persistence
 
{ 
public 

	interface 
IDatabaseContext %
{ 
DbSet 
< 
AlarmsRecord 
>  
AlarmsRecords! 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
int

 
SaveChanges

 
(

 
)

 
;

 
} 
} ï¿½
iE:\Scoala\Anul III\Sem I\i.Net\Project\Microservices\Alarms\Persistence\Maps\AlarmsRecordMap.cs
	namespace 	
Persistence
 
. 
Maps 
{ 
sealed 

class  
AlarmsRecordMap %
:& '$
IEntityTypeConfiguration( @
<@ A
AlarmsRecordA R
>R S
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
AlarmsRecord		0 A
>		A B
builder		C J
)		J K
{

 	
builder 
. 
HasKey 
( 
id 
=>  
id! #
.# $
Id$ &
)& '
;' (
builder 
. 
Property 
( 
id 
=>  "
id# %
.% &
Id& (
)( )
. 
HasColumnName 
( 
$str #
)# $
;$ %
builder 
. 
Property 
( 
time !
=>" $
time% )
.) *
Time* .
). /
. 

IsRequired 
( 
) 
. 
HasColumnName 
( 
$str %
)% &
;& '
builder 
. 
Property 
( 
user !
=>" $
user% )
.) *
UserId* 0
)0 1
. 

IsRequired 
( 
) 
. 
HasColumnName 
( 
$str '
)' (
;( )
builder 
. 
Property 
( 
val  
=>! #
val$ '
.' (
Value( -
)- .
. 

IsRequired 
( 
) 
. 
HasColumnName 
( 
$str &
)& '
;' (
} 	
} 
} ï¿½
zE:\Scoala\Anul III\Sem I\i.Net\Project\Microservices\Alarms\Persistence\Migrations\20171218173139_InitialMigration.cs
	namespace 	
Persistence
 
. 

Migrations  
{ 
public 

partial 
class 
InitialMigration )
:* +
	Migration, 5
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str *
,* +
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
Guid& *
>* +
(+ ,
nullable, 4
:4 5
false6 ;
); <
,< =
Time 
= 
table  
.  !
Column! '
<' (
DateTime( 0
>0 1
(1 2
nullable2 :
:: ;
false< A
)A B
,B C
UserId 
= 
table "
." #
Column# )
<) *
Guid* .
>. /
(/ 0
nullable0 8
:8 9
false: ?
)? @
,@ A
Value 
= 
table !
.! "
Column" (
<( )
double) /
>/ 0
(0 1
nullable1 9
:9 :
false; @
)@ A
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% <
,< =
x> ?
=>@ B
xC D
.D E
IdE G
)G H
;H I
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str *
)* +
;+ ,
} 	
} 
}   ï¿½+
eE:\Scoala\Anul III\Sem I\i.Net\Project\Microservices\Alarms\Persistence\Seeders\DbInitializer.cs
	namespace 	
Persistence
 
. 
Seeders 
{ 
public 

static 
class 
DbInitializer %
{ 
public		 
static		 
void		 
Seed		 
(		  
DatabaseContext		  /
context		0 7
)		7 8
{

 	
context 
. 
Database 
. 
EnsureCreated *
(* +
)+ ,
;, -
if 
( 
context 
. 
AlarmsRecords *
.* +
Any+ .
(. /
)/ 0
)0 1
{ 
return 
; 
} 
var 
records 
= 
new 
[ 
] 
{ 
new 
AlarmsRecord %
{ 
UserId 
= 
new  
Guid! %
(% &
$str& L
)L M
,M N
Value 
= 
$num 
, 
Time 
= 
new 
DateTime '
(' (
$num( ,
,, -
$num. 0
,0 1
$num2 4
,4 5
$num6 8
,8 9
$num: <
,< =
$num> @
)@ A
} 
, 
new 
AlarmsRecord %
{ 
UserId 
= 
new  
Guid! %
(% &
$str& L
)L M
,M N
Value 
= 
$num 
, 
Time 
= 
new 
DateTime '
(' (
$num( ,
,, -
$num. 0
,0 1
$num2 4
,4 5
$num6 8
,8 9
$num: <
,< =
$num> @
)@ A
} 
, 
new   
AlarmsRecord   %
{!! 
UserId"" 
="" 
new""  
Guid""! %
(""% &
$str""& L
)""L M
,""M N
Value## 
=## 
$num## 
,## 
Time$$ 
=$$ 
new$$ 
DateTime$$ '
($$' (
$num$$( ,
,$$, -
$num$$. 0
,$$0 1
$num$$2 4
,$$4 5
$num$$6 8
,$$8 9
$num$$: <
,$$< =
$num$$> @
)$$@ A
}%% 
,%% 
new&& 
AlarmsRecord&& %
{'' 
UserId(( 
=(( 
new((  
Guid((! %
(((% &
$str((& L
)((L M
,((M N
Value)) 
=)) 
$num)) 
,)) 
Time** 
=** 
new** 
DateTime** '
(**' (
$num**( ,
,**, -
$num**. 0
,**0 1
$num**2 4
,**4 5
$num**6 8
,**8 9
$num**: <
,**< =
$num**> ?
)**? @
}++ 
,++ 
new,, 
AlarmsRecord,, %
{-- 
UserId.. 
=.. 
new..  
Guid..! %
(..% &
$str..& L
)..L M
,..M N
Value// 
=// 
$num// 
,// 
Time00 
=00 
new00 
DateTime00 '
(00' (
$num00( ,
,00, -
$num00. 0
,000 1
$num002 4
,004 5
$num006 8
,008 9
$num00: <
,00< =
$num00> @
)00@ A
}11 
,11 
new22 
AlarmsRecord22 %
{33 
UserId44 
=44 
new44  
Guid44! %
(44% &
$str44& L
)44L M
,44M N
Value55 
=55 
$num55 
,55 
Time66 
=66 
new66 
DateTime66 '
(66' (
$num66( ,
,66, -
$num66. 0
,660 1
$num662 4
,664 5
$num666 8
,668 9
$num66: <
,66< =
$num66> @
)66@ A
}77 
,77 
new88 
AlarmsRecord88 %
{99 
UserId:: 
=:: 
new::  
Guid::! %
(::% &
$str::& L
)::L M
,::M N
Value;; 
=;; 
$num;; 
,;; 
Time<< 
=<< 
new<< 
DateTime<< '
(<<' (
$num<<( ,
,<<, -
$num<<. 0
,<<0 1
$num<<2 4
,<<4 5
$num<<6 8
,<<8 9
$num<<: <
,<<< =
$num<<> @
)<<@ A
}== 
}>> 
;>> 
foreach@@ 
(@@ 
AlarmsRecord@@ &
r@@' (
in@@) +
records@@, 3
)@@3 4
{AA 
contextBB 
.BB 
AlarmsRecordsBB *
.BB* +
AddBB+ .
(BB. /
rBB/ 0
)BB0 1
;BB1 2
}CC 
contextEE 
.EE 
SaveChangesEE 
(EE  
)EE  !
;EE! "
}FF 	
}GG 
}HH 